"0","transformed_dat <- full_dat %>%"
"0","  # Extract unit number from SSPS_ID"
"0","  separate(SSPS_ID, c(""unit"", ""ssps_end""), sep = 2) %>%"
"0","  # Create unit id by uniting  unit number with office number"
"0","  unite(unit_id, c(""unit"", ""office_number""), sep = """", remove = FALSE) %>%"
"0","  # Recode program areas where 'No = 2' or is NA to 0"
"0","  mutate(q1a = ifelse(q1a == 2 | is.na(q1a), 0, q1a),"
"0","         q1b = ifelse(q1b == 2 | is.na(q1b), 0, q1b),"
"0","         q1c = ifelse(q1c == 2 | is.na(q1c), 0, q1c),"
"0","         q1d = ifelse(q1d == 2 | is.na(q1d), 0, q1d),"
"0","         q1e = ifelse(q1e == 2 | is.na(q1e), 0, q1e),"
"0","         q1f = ifelse(q1f == 2 | is.na(q1f), 0, q1f),"
"0","         q1g = ifelse(q1g == 2 | is.na(q1g), 0, q1g),"
"0","         q1h = ifelse(q1h == 2 | is.na(q1h), 0, q1h)) %>%"
"0","  # Create count of program areas per worker"
"0","  mutate(prg_area_sum = rowSums(dplyr::select(., q1a:q1h), na.rm = TRUE)) %>%"
"0","  # Flag where worker only has one of the 'Other' roles"
"0","  mutate(only_dlr_cps = ifelse(q1a == 0 & q1b == 0 & q1c == 0 & q1d == 0 & q1e == 1, 1, 0),"
"0","         only_dlr_lic = ifelse(q1a == 0 & q1b == 0 & q1c == 0 & q1d == 0 & q1f == 1, 1, 0),"
"0","         only_intake = ifelse(q1a == 0 & q1b == 0 & q1c == 0 & q1d == 0 & q1g == 1, 1, 0),"
"0","         only_adoption = ifelse(q1a == 0 & q1b == 0 & q1c == 0 & q1d == 0 & q1h == 1, 1, 0),"
"0","         only_other = ifelse(only_dlr_cps == 1 | only_dlr_lic == 1 | only_intake == 1 | only_adoption == 1, 1, 0))"
